using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Web.Services.Protocols;
using WSSAT.DataTypes;

namespace WSSAT.BusinessLayer
{
    public class InformationDisclosureVulnerabilityScanner
    {
        private MainForm mainForm;

        public InformationDisclosureVulnerabilityScanner(MainForm mainForm)
        {
            this.mainForm = mainForm;
        }

        public string ScanIt(InformationDisclosureVulnerability infoVuln, List<Param> respHeader)
        {
            string result = string.Empty;

            if (respHeader != null && respHeader.Count() > 0)
            {
                Param p = respHeader.Where(rh => rh.Name.ToLowerInvariant().Equals(infoVuln.tagName.ToLowerInvariant())).FirstOrDefault();

                if (infoVuln.missing == 0)
                {
                    if (p != null)
                    {
                        result = p.Value;
                    }
                }
                else
                {
                    if (p == null)
                    {
                        result = "Missing Tag";
                    }
                }
            }

            return result;
        }
    }
}
